<<<<<<< HEAD
{"version":3,"sources":["../../src/core/settings/pages/space-usage/space-usage.module.ts","../../src/core/settings/pages/space-usage/space-usage.ts"],"names":[],"mappings":"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","file":"19.js","sourcesContent":["// (C) Copyright 2015 Martin Dougiamas\r\n//\r\n// Licensed under the Apache License, Version 2.0 (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n//     http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n\r\nimport { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { CoreSettingsSpaceUsagePage } from './space-usage';\r\nimport { CoreComponentsModule } from '@components/components.module';\r\nimport { CoreDirectivesModule } from '@directives/directives.module';\r\nimport { CorePipesModule } from '@pipes/pipes.module';\r\n\r\n@NgModule({\r\n    declarations: [\r\n        CoreSettingsSpaceUsagePage\r\n    ],\r\n    imports: [\r\n        CoreComponentsModule,\r\n        CoreDirectivesModule,\r\n        CorePipesModule,\r\n        IonicPageModule.forChild(CoreSettingsSpaceUsagePage),\r\n        TranslateModule.forChild()\r\n    ],\r\n})\r\nexport class CoreSettingsSpaceUsagePageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/settings/pages/space-usage/space-usage.module.ts","// (C) Copyright 2015 Martin Dougiamas\r\n//\r\n// Licensed under the Apache License, Version 2.0 (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n//     http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n\r\nimport { Component, } from '@angular/core';\r\nimport { IonicPage } from 'ionic-angular';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { CoreAppProvider } from '@providers/app';\r\nimport { CoreFilepoolProvider } from '@providers/filepool';\r\nimport { CoreSitesProvider } from '@providers/sites';\r\nimport { CoreTextUtilsProvider } from '@providers/utils/text';\r\nimport { CoreDomUtilsProvider } from '@providers/utils/dom';\r\n\r\n/**\r\n * Page that displays the space usage settings.\r\n */\r\n@IonicPage({segment: 'core-settings-space-usage'})\r\n@Component({\r\n    selector: 'page-core-settings-space-usage',\r\n    templateUrl: 'space-usage.html',\r\n})\r\nexport class CoreSettingsSpaceUsagePage {\r\n\r\n    usageLoaded = false;\r\n    sites = [];\r\n    currentSiteId = '';\r\n    totalUsage = 0;\r\n\r\n    constructor(private filePoolProvider: CoreFilepoolProvider,\r\n            private sitesProvider: CoreSitesProvider, private textUtils: CoreTextUtilsProvider,\r\n            private translate: TranslateService, private domUtils: CoreDomUtilsProvider, appProvider: CoreAppProvider) {\r\n        this.currentSiteId = this.sitesProvider.getCurrentSiteId();\r\n    }\r\n\r\n    /**\r\n     * View loaded.\r\n     */\r\n    ionViewDidLoad(): void {\r\n        this.fetchData().finally(() => {\r\n            this.usageLoaded = true;\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Convenience function to calculate each site's usage, and the total usage.\r\n     *\r\n     * @return {Promise<any>} Resolved when done.\r\n     */\r\n    protected calculateSizeUsage(): Promise<any> {\r\n        return this.sitesProvider.getSortedSites().then((sites) => {\r\n            this.sites = sites;\r\n\r\n            // Get space usage.\r\n            const promises = this.sites.map((siteEntry) => {\r\n                return this.sitesProvider.getSite(siteEntry.id).then((site) => {\r\n                    return site.getSpaceUsage().then((size) => {\r\n                        siteEntry.spaceUsage = size;\r\n                    });\r\n                });\r\n            });\r\n\r\n            return Promise.all(promises);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Convenience function to calculate total usage.\r\n     */\r\n    protected calculateTotalUsage(): void {\r\n        let total = 0;\r\n        this.sites.forEach((site) => {\r\n            if (site.spaceUsage) {\r\n                total += parseInt(site.spaceUsage, 10);\r\n            }\r\n        });\r\n        this.totalUsage = total;\r\n    }\r\n\r\n    /**\r\n     * Convenience function to calculate space usage.\r\n     *\r\n     * @return {Promise<any>} Resolved when done.\r\n     */\r\n    protected fetchData(): Promise<any> {\r\n        const promises = [\r\n            this.calculateSizeUsage().then(() => this.calculateTotalUsage()),\r\n        ];\r\n\r\n        return Promise.all(promises);\r\n    }\r\n\r\n    /**\r\n     * Refresh the data.\r\n     *\r\n     * @param {any} refresher Refresher.\r\n     */\r\n    refreshData(refresher: any): void {\r\n        this.fetchData().finally(() => {\r\n            refresher.complete();\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Convenience function to update site size, along with total usage.\r\n     *\r\n     * @param {any} site Site object with space usage.\r\n     * @param {number} newUsage New space usage of the site in bytes.\r\n     */\r\n    protected updateSiteUsage(site: any, newUsage: number): void {\r\n        const oldUsage = site.spaceUsage;\r\n        site.spaceUsage = newUsage;\r\n        this.totalUsage -= oldUsage - newUsage;\r\n    }\r\n\r\n    /**\r\n     * Deletes files of a site.\r\n     *\r\n     * @param {any} siteData Site object with space usage.\r\n     */\r\n    deleteSiteFiles(siteData: any): void {\r\n        this.textUtils.formatText(siteData.siteName).then((siteName) => {\r\n            const title = this.translate.instant('core.settings.deletesitefilestitle');\r\n            const message = this.translate.instant('core.settings.deletesitefiles', {sitename: siteName});\r\n\r\n            this.domUtils.showConfirm(message, title).then(() => {\r\n                return this.sitesProvider.getSite(siteData.id);\r\n            }).then((site) => {\r\n                site.deleteFolder().then(() => {\r\n                    this.filePoolProvider.clearAllPackagesStatus(site.id);\r\n                    this.filePoolProvider.clearFilepool(site.id);\r\n                    this.updateSiteUsage(siteData, 0);\r\n                }).catch((error) => {\r\n                    if (error && error.code === FileError.NOT_FOUND_ERR) {\r\n                        // Not found, set size 0.\r\n                        this.filePoolProvider.clearAllPackagesStatus(site.id);\r\n                        this.updateSiteUsage(siteData, 0);\r\n                    } else {\r\n                        // Error, recalculate the site usage.\r\n                        this.domUtils.showErrorModal('core.settings.errordeletesitefiles', true);\r\n                        site.getSpaceUsage().then((size) => {\r\n                            this.updateSiteUsage(siteData, size);\r\n                        });\r\n                    }\r\n                });\r\n            }).catch(() => {\r\n                // Ignore cancelled confirmation modal.\r\n            });\r\n        });\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/settings/pages/space-usage/space-usage.ts"],"sourceRoot":""}
=======
{"version":3,"sources":["../../src/core/settings/pages/synchronization/synchronization.module.ts","../../src/core/settings/pages/synchronization/synchronization.ts"],"names":[],"mappings":"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","file":"19.js","sourcesContent":["// (C) Copyright 2015 Martin Dougiamas\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { CoreSettingsSynchronizationPage } from './synchronization';\nimport { CoreComponentsModule } from '@components/components.module';\nimport { CoreDirectivesModule } from '@directives/directives.module';\nimport { CorePipesModule } from '@pipes/pipes.module';\n\n@NgModule({\n    declarations: [\n        CoreSettingsSynchronizationPage\n    ],\n    imports: [\n        CoreComponentsModule,\n        CoreDirectivesModule,\n        CorePipesModule,\n        IonicPageModule.forChild(CoreSettingsSynchronizationPage),\n        TranslateModule.forChild()\n    ],\n})\nexport class CoreSettingsSynchronizationPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/settings/pages/synchronization/synchronization.module.ts","// (C) Copyright 2015 Martin Dougiamas\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Component, OnDestroy } from '@angular/core';\nimport { IonicPage } from 'ionic-angular';\nimport { CoreConstants } from '@core/constants';\nimport { CoreEventsProvider } from '@providers/events';\nimport { CoreSitesProvider, CoreSiteBasicInfo } from '@providers/sites';\nimport { CoreDomUtilsProvider } from '@providers/utils/dom';\nimport { CoreConfigProvider } from '@providers/config';\nimport { CoreSettingsHelper } from '@core/settings/providers/helper';\n\n/**\n * Page that displays the synchronization settings.\n */\n@IonicPage({segment: 'core-settings-synchronization'})\n@Component({\n    selector: 'page-core-settings-synchronization',\n    templateUrl: 'synchronization.html',\n})\nexport class CoreSettingsSynchronizationPage implements OnDestroy {\n\n    sites: CoreSiteBasicInfo[] = [];\n    sitesLoaded = false;\n    sitesObserver: any;\n    currentSiteId = '';\n    syncOnlyOnWifi = false;\n    isDestroyed = false;\n\n    constructor(private configProvider: CoreConfigProvider, private eventsProvider: CoreEventsProvider,\n            private sitesProvider: CoreSitesProvider, private domUtils: CoreDomUtilsProvider,\n            private settingsHelper: CoreSettingsHelper) {\n\n        this.currentSiteId = this.sitesProvider.getCurrentSiteId();\n\n        this.sitesObserver = this.eventsProvider.on(CoreEventsProvider.SITE_UPDATED, (data) => {\n            this.sitesProvider.getSite(data.siteId).then((site) => {\n                const siteInfo = site.getInfo();\n                const siteEntry = this.sites.find((siteEntry) => siteEntry.id == site.id);\n                if (siteEntry) {\n                    siteEntry.siteUrl = siteInfo.siteurl;\n                    siteEntry.siteName = siteInfo.sitename;\n                    siteEntry.fullName = siteInfo.fullname;\n                }\n            });\n        });\n    }\n\n    /**\n     * View loaded.\n     */\n    ionViewDidLoad(): void {\n        this.sitesProvider.getSortedSites().then((sites) => {\n            this.sites = sites;\n        }).finally(() => {\n            this.sitesLoaded = true;\n        });\n\n        this.configProvider.get(CoreConstants.SETTINGS_SYNC_ONLY_ON_WIFI, true).then((syncOnlyOnWifi) => {\n            this.syncOnlyOnWifi = !!syncOnlyOnWifi;\n        });\n    }\n\n    /**\n     * Called when sync only on wifi setting is enabled or disabled.\n     */\n    syncOnlyOnWifiChanged(): void {\n        this.configProvider.set(CoreConstants.SETTINGS_SYNC_ONLY_ON_WIFI, this.syncOnlyOnWifi ? 1 : 0);\n    }\n\n    /**\n     * Syncrhonizes a site.\n     *\n     * @param {string} siteId Site ID.\n     */\n    synchronize(siteId: string): void {\n        this.settingsHelper.synchronizeSite(this.syncOnlyOnWifi, siteId).catch((error) => {\n            if (this.isDestroyed) {\n                return;\n            }\n            this.domUtils.showErrorModalDefault(error, 'core.settings.errorsyncsite', true);\n        });\n    }\n\n    /**\n     * Returns true if site is beeing synchronized.\n     *\n     * @param {string} siteId Site ID.\n     * @return {boolean} True if site is beeing synchronized, false otherwise.\n     */\n    isSynchronizing(siteId: string): boolean {\n        return !!this.settingsHelper.getSiteSyncPromise(siteId);\n    }\n\n    /**\n     * Page destroyed.\n     */\n    ngOnDestroy(): void {\n        this.isDestroyed = true;\n        this.sitesObserver && this.sitesObserver.off();\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/settings/pages/synchronization/synchronization.ts"],"sourceRoot":""}
>>>>>>> 5632a65c1fdc0002876490b68e6dc6621a0dd43d
