<<<<<<< HEAD
{"version":3,"sources":["../../src/addon/mod/data/pages/search/search.module.ts","../../src/addon/mod/data/pages/search/search.ts"],"names":[],"mappings":"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","file":"89.js","sourcesContent":["// (C) Copyright 2015 Martin Dougiamas\r\n//\r\n// Licensed under the Apache License, Version 2.0 (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n//     http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n\r\nimport { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { CoreDirectivesModule } from '@directives/directives.module';\r\nimport { AddonModDataComponentsModule } from '../../components/components.module';\r\nimport { AddonModDataSearchPage } from './search';\r\nimport { CoreCompileHtmlComponentModule } from '@core/compile/components/compile-html/compile-html.module';\r\n\r\n@NgModule({\r\n    declarations: [\r\n        AddonModDataSearchPage,\r\n    ],\r\n    imports: [\r\n        CoreDirectivesModule,\r\n        AddonModDataComponentsModule,\r\n        CoreCompileHtmlComponentModule,\r\n        IonicPageModule.forChild(AddonModDataSearchPage),\r\n        TranslateModule.forChild()\r\n    ],\r\n})\r\nexport class AddonModDataSearchPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/addon/mod/data/pages/search/search.module.ts","// (C) Copyright 2015 Martin Dougiamas\r\n//\r\n// Licensed under the Apache License, Version 2.0 (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n//     http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n\r\nimport { Component } from '@angular/core';\r\nimport { IonicPage, NavParams, ViewController } from 'ionic-angular';\r\nimport { FormBuilder, FormGroup } from '@angular/forms';\r\nimport { CoreUtilsProvider } from '@providers/utils/utils';\r\nimport { CoreDomUtilsProvider } from '@providers/utils/dom';\r\nimport { CoreTextUtilsProvider } from '@providers/utils/text';\r\nimport { AddonModDataComponentsModule } from '../../components/components.module';\r\nimport { AddonModDataFieldsDelegate } from '../../providers/fields-delegate';\r\n\r\n/**\r\n * Page that displays the search modal.\r\n */\r\n@IonicPage({ segment: 'addon-mod-data-search' })\r\n@Component({\r\n    selector: 'page-addon-mod-data-search',\r\n    templateUrl: 'search.html',\r\n})\r\nexport class AddonModDataSearchPage {\r\n    search: any;\r\n    fields: any;\r\n    data: any;\r\n    advancedSearch: any;\r\n    extraImports = [AddonModDataComponentsModule];\r\n    searchForm: FormGroup;\r\n    jsData: any;\r\n    fieldsArray: any;\r\n\r\n    constructor(params: NavParams, private viewCtrl: ViewController, fb: FormBuilder, protected utils: CoreUtilsProvider,\r\n            protected domUtils: CoreDomUtilsProvider, protected fieldsDelegate: AddonModDataFieldsDelegate,\r\n            protected textUtils: CoreTextUtilsProvider) {\r\n        this.search = params.get('search');\r\n        this.fields = params.get('fields');\r\n        this.data = params.get('data');\r\n\r\n        const advanced = {};\r\n        if (typeof this.search.advanced == 'object') {\r\n            Object.keys(this.search.advanced).forEach((index) => {\r\n                if (typeof this.search.advanced[index] != 'undefined' && typeof this.search.advanced[index].name != 'undefined') {\r\n                    advanced[this.search.advanced[index].name] = this.search.advanced[index].value ?\r\n                        this.textUtils.parseJSON(this.search.advanced[index].value) : '';\r\n                } else {\r\n                    advanced[index] = this.search.advanced[index] ?\r\n                        this.textUtils.parseJSON(this.search.advanced[index]) : '';\r\n                }\r\n            });\r\n        } else {\r\n            this.search.advanced.forEach((field) => {\r\n                advanced[field.name] = field.value ? this.textUtils.parseJSON(field.value) : '';\r\n            });\r\n        }\r\n        this.search.advanced = advanced;\r\n\r\n        this.searchForm = fb.group({\r\n            text: [this.search.text],\r\n            sortBy: [this.search.sortBy || '0'],\r\n            sortDirection: [this.search.sortDirection || 'DESC'],\r\n            firstname: [this.search.advanced['firstname'] || ''],\r\n            lastname: [this.search.advanced['lastname'] || '']\r\n        });\r\n\r\n        this.fieldsArray = this.utils.objectToArray(this.fields);\r\n        this.advancedSearch = this.renderAdvancedSearchFields();\r\n    }\r\n\r\n    /**\r\n     * Displays Advanced Search Fields.\r\n     *\r\n     * @return {string}         Generated HTML.\r\n     */\r\n    protected renderAdvancedSearchFields(): string {\r\n        if (!this.data.asearchtemplate) {\r\n            return '';\r\n        }\r\n\r\n        this.jsData = {\r\n            fields: this.fields,\r\n            form: this.searchForm,\r\n            search: this.search.advanced\r\n        };\r\n\r\n        let template = this.data.asearchtemplate,\r\n            replace, render;\r\n\r\n        // Replace the fields found on template.\r\n        this.fieldsArray.forEach((field) => {\r\n            replace = '[[' + field.name + ']]';\r\n            replace = replace.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, '\\\\$&');\r\n            replace = new RegExp(replace, 'gi');\r\n\r\n            // Replace field by a generic directive.\r\n            render = '<addon-mod-data-field-plugin mode=\"search\" [field]=\"fields[' + field.id +\r\n                ']\" [form]=\"form\" [search]=\"search\"></addon-mod-data-field-plugin>';\r\n            template = template.replace(replace, render);\r\n        });\r\n\r\n        // Not pluginable other search elements.\r\n        // Replace firstname field by the text input.\r\n        replace = new RegExp('##firstname##', 'gi');\r\n        render = '<span [formGroup]=\"form\"><ion-input type=\"text\" name=\"firstname\" \\\r\n        [placeholder]=\"\\'addon.mod_data.authorfirstname\\' | translate\" formControlName=\"firstname\"></ion-input></span>';\r\n        template = template.replace(replace, render);\r\n\r\n        // Replace lastname field by the text input.\r\n        replace = new RegExp('##lastname##', 'gi');\r\n        render = '<span [formGroup]=\"form\"><ion-input type=\"text\" name=\"lastname\" \\\r\n        [placeholder]=\"\\'addon.mod_data.authorlastname\\' | translate\" formControlName=\"lastname\"></ion-input></span>';\r\n        template = template.replace(replace, render);\r\n\r\n        return template;\r\n    }\r\n\r\n    /**\r\n     * Retrieve the entered data in search in a form.\r\n     *\r\n     * @param {any} searchedData Array with the entered form values.\r\n     * @return {any[]}          Array with the answers.\r\n     */\r\n    getSearchDataFromForm(searchedData: any): any[] {\r\n        const advancedSearch = [];\r\n\r\n        // Filter and translate fields to each field plugin.\r\n        this.fieldsArray.forEach((field) => {\r\n            const fieldData = this.fieldsDelegate.getFieldSearchData(field, searchedData);\r\n\r\n            if (fieldData) {\r\n                fieldData.forEach((data) => {\r\n                    data.value = JSON.stringify(data.value);\r\n                    // WS wants values in Json format.\r\n                    advancedSearch.push(data);\r\n                });\r\n            }\r\n        });\r\n\r\n        // Not pluginable other search elements.\r\n        if (searchedData['firstname']) {\r\n            // WS wants values in Json format.\r\n            advancedSearch.push({\r\n                name: 'firstname',\r\n                value: JSON.stringify(searchedData['firstname'])\r\n            });\r\n        }\r\n\r\n        if (searchedData['lastname']) {\r\n            // WS wants values in Json format.\r\n            advancedSearch.push({\r\n                name: 'lastname',\r\n                value: JSON.stringify(searchedData['lastname'])\r\n            });\r\n        }\r\n\r\n        return advancedSearch;\r\n    }\r\n\r\n    /**\r\n     * Close modal.\r\n     *\r\n     * @param {any} [data] Data to return to the page.\r\n     */\r\n    closeModal(data?: any): void {\r\n        this.viewCtrl.dismiss(data);\r\n    }\r\n\r\n    /**\r\n     * Toggles between advanced to normal search.\r\n     */\r\n    toggleAdvanced(): void {\r\n        this.search.searchingAdvanced = !this.search.searchingAdvanced;\r\n    }\r\n\r\n    /**\r\n     * Done editing.\r\n     */\r\n    searchEntries(): void {\r\n        const searchedData = this.searchForm.value;\r\n\r\n        if (this.search.searchingAdvanced) {\r\n            this.search.advanced = this.getSearchDataFromForm(searchedData);\r\n            this.search.searching = this.search.advanced.length > 0;\r\n        } else {\r\n            this.search.text = searchedData.text;\r\n            this.search.searching = this.search.text.length > 0;\r\n        }\r\n\r\n        this.search.sortBy = searchedData.sortBy;\r\n        this.search.sortDirection = searchedData.sortDirection;\r\n\r\n        this.closeModal(this.search);\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/addon/mod/data/pages/search/search.ts"],"sourceRoot":""}
=======
{"version":3,"sources":["../../src/addon/mod/feedback/pages/form/form.module.ts","../../src/addon/mod/feedback/pages/form/form.ts"],"names":[],"mappings":"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","file":"89.js","sourcesContent":["// (C) Copyright 2015 Martin Dougiamas\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { CoreDirectivesModule } from '@directives/directives.module';\nimport { CoreComponentsModule } from '@components/components.module';\nimport { AddonModFeedbackComponentsModule } from '../../components/components.module';\nimport { AddonModFeedbackFormPage } from './form';\n\n@NgModule({\n    declarations: [\n        AddonModFeedbackFormPage,\n    ],\n    imports: [\n        CoreDirectivesModule,\n        CoreComponentsModule,\n        AddonModFeedbackComponentsModule,\n        IonicPageModule.forChild(AddonModFeedbackFormPage),\n        TranslateModule.forChild()\n    ],\n})\nexport class AddonModFeedbackFormPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/addon/mod/feedback/pages/form/form.module.ts","// (C) Copyright 2015 Martin Dougiamas\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Component, OnDestroy, Optional, NgZone } from '@angular/core';\nimport { IonicPage, NavParams, NavController, Content } from 'ionic-angular';\nimport { Network } from '@ionic-native/network';\nimport { TranslateService } from '@ngx-translate/core';\nimport { AddonModFeedbackProvider } from '../../providers/feedback';\nimport { AddonModFeedbackHelperProvider } from '../../providers/helper';\nimport { AddonModFeedbackSyncProvider } from '../../providers/sync';\nimport { CoreDomUtilsProvider } from '@providers/utils/dom';\nimport { CoreUtilsProvider } from '@providers/utils/utils';\nimport { CoreAppProvider } from '@providers/app';\nimport { CoreEventsProvider } from '@providers/events';\nimport { CoreCourseProvider } from '@core/course/providers/course';\nimport { CoreLoginHelperProvider } from '@core/login/providers/helper';\nimport { CoreContentLinksHelperProvider } from '@core/contentlinks/providers/helper';\nimport { CoreSitesProvider } from '@providers/sites';\n\n/**\n * Page that displays feedback form.\n */\n@IonicPage({ segment: 'addon-mod-feedback-form' })\n@Component({\n    selector: 'page-addon-mod-feedback-form',\n    templateUrl: 'form.html',\n})\nexport class AddonModFeedbackFormPage implements OnDestroy {\n\n    protected module: any;\n    protected currentPage: number;\n    protected submitted: any;\n    protected feedback;\n    protected siteAfterSubmit;\n    protected onlineObserver;\n    protected originalData;\n    protected currentSite;\n    protected forceLeave = false;\n\n    title: string;\n    preview = false;\n    courseId: number;\n    componentId: number;\n    completionPageContents: string;\n    component = AddonModFeedbackProvider.COMPONENT;\n    offline = false;\n    feedbackLoaded = false;\n    access: any;\n    items = [];\n    hasPrevPage = false;\n    hasNextPage = false;\n    completed = false;\n    completedOffline = false;\n\n    constructor(navParams: NavParams, protected feedbackProvider: AddonModFeedbackProvider, protected appProvider: CoreAppProvider,\n            protected utils: CoreUtilsProvider, protected domUtils: CoreDomUtilsProvider, protected navCtrl: NavController,\n            protected feedbackHelper: AddonModFeedbackHelperProvider, protected courseProvider: CoreCourseProvider,\n            protected eventsProvider: CoreEventsProvider, protected feedbackSync: AddonModFeedbackSyncProvider, network: Network,\n            protected translate: TranslateService, protected loginHelper: CoreLoginHelperProvider,\n            protected linkHelper: CoreContentLinksHelperProvider, sitesProvider: CoreSitesProvider,\n            @Optional() private content: Content, zone: NgZone) {\n\n        this.module = navParams.get('module');\n        this.courseId = navParams.get('courseId');\n        this.currentPage = navParams.get('page');\n        this.title = navParams.get('title');\n        this.preview = !!navParams.get('preview');\n        this.componentId = navParams.get('moduleId') || this.module.id;\n\n        this.currentSite = sitesProvider.getCurrentSite();\n\n        // Refresh online status when changes.\n        this.onlineObserver = network.onchange().subscribe((online) => {\n            // Execute the callback in the Angular zone, so change detection doesn't stop working.\n            zone.run(() => {\n                this.offline = !online;\n            });\n        });\n    }\n\n    /**\n     * View loaded.\n     */\n    ionViewDidLoad(): void {\n        this.fetchData().then(() => {\n            this.feedbackProvider.logView(this.feedback.id, true).then(() => {\n                this.courseProvider.checkModuleCompletion(this.courseId, this.module.completiondata);\n            }).catch(() => {\n                // Ignore errors.\n            });\n        });\n    }\n\n    /**\n     * View entered.\n     */\n    ionViewDidEnter(): void {\n        this.forceLeave = false;\n    }\n\n    /**\n     * Check if we can leave the page or not.\n     *\n     * @return {boolean | Promise<void>} Resolved if we can leave it, rejected if not.\n     */\n    ionViewCanLeave(): boolean | Promise<void> {\n        if (this.forceLeave) {\n            return true;\n        }\n\n        if (!this.preview) {\n            const responses = this.feedbackHelper.getPageItemsResponses(this.items);\n\n            if (this.items && !this.completed && this.originalData) {\n                // Form submitted. Check if there is any change.\n                if (!this.utils.basicLeftCompare(responses, this.originalData, 3)) {\n                     return this.domUtils.showConfirm(this.translate.instant('core.confirmcanceledit'));\n                }\n            }\n        }\n\n        return Promise.resolve();\n    }\n\n    /**\n     * Fetch all the data required for the view.\n     *\n     * @return {Promise<any>} Promise resolved when done.\n     */\n    protected fetchData(): Promise<any> {\n        this.offline = !this.appProvider.isOnline();\n\n        return this.feedbackProvider.getFeedback(this.courseId, this.module.id).then((feedbackData) => {\n            this.feedback = feedbackData;\n\n            this.title = this.feedback.name || this.title;\n\n            return this.fetchAccessData();\n        }).then((accessData) => {\n            if (!this.preview && accessData.cansubmit && !accessData.isempty) {\n                return typeof this.currentPage == 'undefined' ?\n                    this.feedbackProvider.getResumePage(this.feedback.id, this.offline, true) :\n                    Promise.resolve(this.currentPage);\n            } else {\n                this.preview = true;\n\n                return Promise.resolve(0);\n            }\n        }).catch((error) => {\n            if (!this.offline && !this.utils.isWebServiceError(error)) {\n                // If it fails, go offline.\n                this.offline = true;\n\n                return this.feedbackProvider.getResumePage(this.feedback.id, true);\n            }\n\n            return Promise.reject(error);\n        }).then((page) => {\n            return this.fetchFeedbackPageData(page || 0);\n        }).catch((message) => {\n            this.domUtils.showErrorModalDefault(message, 'core.course.errorgetmodule', true);\n            this.forceLeave = true;\n            this.navCtrl.pop();\n\n            return Promise.reject(null);\n        }).finally(() => {\n            this.feedbackLoaded = true;\n        });\n    }\n\n    /**\n     * Fetch access information.\n     *\n     * @return {Promise<any>} Promise resolved when done.\n     */\n    protected fetchAccessData(): Promise<any> {\n        return this.feedbackProvider.getFeedbackAccessInformation(this.feedback.id, this.offline, true).catch((error) => {\n            if (!this.offline && !this.utils.isWebServiceError(error)) {\n                // If it fails, go offline.\n                this.offline = true;\n\n                return this.feedbackProvider.getFeedbackAccessInformation(this.feedback.id, true);\n            }\n\n            return Promise.reject(error);\n         }).then((accessData) => {\n            this.access = accessData;\n\n            return accessData;\n         });\n    }\n\n    protected fetchFeedbackPageData(page: number = 0): Promise<void> {\n        let promise;\n        this.items = [];\n\n        if (this.preview) {\n            promise = this.feedbackProvider.getItems(this.feedback.id);\n        } else {\n            this.currentPage = page;\n\n            promise = this.feedbackProvider.getPageItemsWithValues(this.feedback.id, page, this.offline, true).catch((error) => {\n                if (!this.offline && !this.utils.isWebServiceError(error)) {\n                    // If it fails, go offline.\n                    this.offline = true;\n\n                    return this.feedbackProvider.getPageItemsWithValues(this.feedback.id, page, true);\n                }\n\n                return Promise.reject(error);\n            }).then((response) => {\n                this.hasPrevPage = !!response.hasprevpage;\n                this.hasNextPage = !!response.hasnextpage;\n\n                return response;\n            });\n        }\n\n        return promise.then((response) => {\n            this.items = response.items.map((itemData) => {\n                return this.feedbackHelper.getItemForm(itemData, this.preview);\n            }).filter((itemData) => {\n                // Filter items with errors.\n                return itemData;\n            });\n\n            if (!this.preview) {\n                const itemsCopy = this.utils.clone(this.items); // Copy the array to avoid modifications.\n                this.originalData = this.feedbackHelper.getPageItemsResponses(itemsCopy);\n            }\n        });\n    }\n\n    /**\n     * Function to allow page navigation through the questions form.\n     *\n     * @param  {boolean}       goPrevious If true it will go back to the previous page, if false, it will go forward.\n     * @return {Promise<void>}            Resolved when done.\n     */\n    gotoPage(goPrevious: boolean): Promise<void> {\n        this.domUtils.scrollToTop(this.content);\n        this.feedbackLoaded = false;\n\n        const responses = this.feedbackHelper.getPageItemsResponses(this.items),\n            formHasErrors = this.items.some((item) => {\n                return item.isEmpty || item.hasError;\n            });\n\n        // Sync other pages first.\n        return this.feedbackSync.syncFeedback(this.feedback.id).catch(() => {\n            // Ignore errors.\n        }).then(() => {\n            return this.feedbackProvider.processPage(this.feedback.id, this.currentPage, responses, goPrevious, formHasErrors,\n                    this.courseId).then((response) => {\n                const jumpTo = parseInt(response.jumpto, 10);\n\n                if (response.completed) {\n                    // Form is completed, show completion message and buttons.\n                    this.items = [];\n                    this.completed = true;\n                    this.completedOffline = !!response.offline;\n                    this.completionPageContents = response.completionpagecontents;\n                    this.siteAfterSubmit = response.siteaftersubmit;\n                    this.submitted = true;\n\n                    // Invalidate access information so user will see home page updated (continue form or completion messages).\n                    const promises = [];\n                    promises.push(this.feedbackProvider.invalidateFeedbackAccessInformationData(this.feedback.id));\n                    promises.push(this.feedbackProvider.invalidateResumePageData(this.feedback.id));\n\n                    return Promise.all(promises).then(() => {\n                        return this.fetchAccessData();\n                    });\n                } else if (isNaN(jumpTo) || jumpTo == this.currentPage) {\n                    // Errors on questions, stay in page.\n                    return Promise.resolve();\n                } else {\n                    this.submitted = true;\n                    // Invalidate access information so user will see home page updated (continue form).\n                    this.feedbackProvider.invalidateResumePageData(this.feedback.id);\n\n                    // Fetch the new page.\n                    return this.fetchFeedbackPageData(jumpTo);\n                }\n            });\n        }).catch((message) => {\n            this.domUtils.showErrorModalDefault(message, 'core.course.errorgetmodule', true);\n\n            return Promise.reject(null);\n        }).finally(() => {\n            this.feedbackLoaded = true;\n        });\n    }\n\n    /**\n     * Function to link implemented features.\n     */\n    showAnalysis(): void {\n        this.submitted = 'analysis';\n        this.feedbackHelper.openFeature('analysis', this.navCtrl, this.module, this.courseId);\n    }\n\n    /**\n     * Function to go to the page after submit.\n     */\n    continue(): void {\n        if (this.siteAfterSubmit) {\n            const modal = this.domUtils.showModalLoading();\n            this.linkHelper.handleLink(this.siteAfterSubmit).then((treated) => {\n                if (!treated) {\n                    return this.currentSite.openInBrowserWithAutoLoginIfSameSite(this.siteAfterSubmit);\n                }\n            }).finally(() => {\n                modal.dismiss();\n            });\n        } else {\n            // Use redirect to make the course the new history root (to avoid \"loops\" in history).\n            this.loginHelper.redirect('CoreCourseSectionPage', {\n                course: { id: this.courseId }\n            }, this.currentSite.getId());\n        }\n    }\n\n    /**\n     * Component being destroyed.\n     */\n    ngOnDestroy(): void {\n        if (this.submitted) {\n            const tab = this.submitted == 'analysis' ? 'analysis' : 'overview';\n            // If form has been submitted, the info has been already invalidated but we should update index view.\n            this.eventsProvider.trigger(AddonModFeedbackProvider.FORM_SUBMITTED, {feedbackId: this.feedback.id, tab: tab});\n        }\n        this.onlineObserver && this.onlineObserver.unsubscribe();\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/addon/mod/feedback/pages/form/form.ts"],"sourceRoot":""}
>>>>>>> 5632a65c1fdc0002876490b68e6dc6621a0dd43d
