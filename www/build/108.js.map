<<<<<<< HEAD
{"version":3,"sources":["../../src/addon/competency/pages/plan/plan.module.ts","../../src/addon/competency/pages/plan/plan.ts"],"names":[],"mappings":"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","file":"108.js","sourcesContent":["// (C) Copyright 2015 Martin Dougiamas\r\n//\r\n// Licensed under the Apache License, Version 2.0 (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n//     http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n\r\nimport { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { CoreComponentsModule } from '@components/components.module';\r\nimport { CoreDirectivesModule } from '@directives/directives.module';\r\nimport { CorePipesModule } from '@pipes/pipes.module';\r\nimport { AddonCompetencyPlanPage } from './plan';\r\n\r\n@NgModule({\r\n    declarations: [\r\n        AddonCompetencyPlanPage,\r\n    ],\r\n    imports: [\r\n        CoreComponentsModule,\r\n        CoreDirectivesModule,\r\n        CorePipesModule,\r\n        IonicPageModule.forChild(AddonCompetencyPlanPage),\r\n        TranslateModule.forChild()\r\n    ],\r\n})\r\nexport class AddonCompetencyPlanPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/addon/competency/pages/plan/plan.module.ts","// (C) Copyright 2015 Martin Dougiamas\r\n//\r\n// Licensed under the Apache License, Version 2.0 (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n//     http://www.apache.org/licenses/LICENSE-2.0\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n\r\nimport { Component, Optional } from '@angular/core';\r\nimport { IonicPage, NavController, NavParams } from 'ionic-angular';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { CoreAppProvider } from '@providers/app';\r\nimport { CoreDomUtilsProvider } from '@providers/utils/dom';\r\nimport { CoreSplitViewComponent } from '@components/split-view/split-view';\r\nimport { AddonCompetencyProvider } from '../../providers/competency';\r\nimport { AddonCompetencyHelperProvider } from '../../providers/helper';\r\n\r\n/**\r\n * Page that displays a learning plan.\r\n */\r\n@IonicPage({ segment: 'addon-competency-plan' })\r\n@Component({\r\n    selector: 'page-addon-competency-plan',\r\n    templateUrl: 'plan.html',\r\n})\r\nexport class AddonCompetencyPlanPage {\r\n    protected planId: number;\r\n    planLoaded = false;\r\n    plan: any;\r\n    user: any;\r\n\r\n    constructor(private navCtrl: NavController, navParams: NavParams, private translate: TranslateService,\r\n            private appProvider: CoreAppProvider, private domUtils: CoreDomUtilsProvider,\r\n            @Optional() private svComponent: CoreSplitViewComponent, private competencyProvider: AddonCompetencyProvider,\r\n            private competencyHelperProvider: AddonCompetencyHelperProvider) {\r\n        this.planId = navParams.get('planId');\r\n    }\r\n\r\n    /**\r\n     * View loaded.\r\n     */\r\n    ionViewDidLoad(): void {\r\n        this.fetchLearningPlan().finally(() => {\r\n            this.planLoaded = true;\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Fetches the learning plan and updates the view.\r\n     *\r\n     * @return {Promise<void>} Promise resolved when done.\r\n     */\r\n    protected fetchLearningPlan(): Promise<void> {\r\n        return this.competencyProvider.getLearningPlan(this.planId).then((plan) => {\r\n            plan.plan.statusname = this.getStatusName(plan.plan.status);\r\n            // Get the user profile image.\r\n            this.competencyHelperProvider.getProfile(plan.plan.userid).then((user) => {\r\n                this.user = user;\r\n            });\r\n            this.plan = plan;\r\n        }).catch((message) => {\r\n            this.domUtils.showErrorModalDefault(message, 'Error getting learning plan data.');\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Navigates to a particular competency.\r\n     *\r\n     * @param {number} competencyId\r\n     */\r\n    openCompetency(competencyId: number): void {\r\n        const navCtrl = this.svComponent ? this.svComponent.getMasterNav() : this.navCtrl;\r\n        if (this.appProvider.isWide()) {\r\n            navCtrl.push('AddonCompetencyCompetenciesPage', {competencyId, planId: this.planId});\r\n        } else {\r\n            navCtrl.push('AddonCompetencyCompetencyPage', {competencyId, planId: this.planId});\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Convenience function to get the status name translated.\r\n     *\r\n     * @param {number} status\r\n     * @return {string}\r\n     */\r\n    protected getStatusName(status: number): string {\r\n        let statusTranslateName;\r\n        switch (status) {\r\n            case AddonCompetencyProvider.STATUS_DRAFT:\r\n                statusTranslateName = 'draft';\r\n                break;\r\n            case AddonCompetencyProvider.REVIEW_STATUS_IN_REVIEW:\r\n                statusTranslateName = 'inreview';\r\n                break;\r\n            case AddonCompetencyProvider.REVIEW_STATUS_WAITING_FOR_REVIEW:\r\n                statusTranslateName = 'waitingforreview';\r\n                break;\r\n            case AddonCompetencyProvider.STATUS_ACTIVE:\r\n                statusTranslateName = 'active';\r\n                break;\r\n            case AddonCompetencyProvider.STATUS_COMPLETE:\r\n                statusTranslateName = 'complete';\r\n                break;\r\n            default:\r\n                // We can use the current status name.\r\n                return String(status);\r\n        }\r\n\r\n        return this.translate.instant('addon.competency.planstatus' + statusTranslateName);\r\n    }\r\n\r\n    /**\r\n     * Refreshes the learning plan.\r\n     *\r\n     * @param {any} refresher Refresher.\r\n     */\r\n    refreshLearningPlan(refresher: any): void {\r\n        this.competencyProvider.invalidateLearningPlan(this.planId).finally(() => {\r\n            this.fetchLearningPlan().finally(() => {\r\n                refresher.complete();\r\n            });\r\n        });\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/addon/competency/pages/plan/plan.ts"],"sourceRoot":""}
=======
{"version":3,"sources":["../../src/addon/messageoutput/airnotifier/pages/devices/devices.module.ts","../../src/addon/messageoutput/airnotifier/pages/devices/devices.ts"],"names":[],"mappings":"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","file":"108.js","sourcesContent":["// (C) Copyright 2015 Martin Dougiamas\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { CoreComponentsModule } from '@components/components.module';\nimport { CoreDirectivesModule } from '@directives/directives.module';\nimport { AddonMessageOutputAirnotifierDevicesPage } from './devices';\n\n@NgModule({\n    declarations: [\n        AddonMessageOutputAirnotifierDevicesPage,\n    ],\n    imports: [\n        CoreComponentsModule,\n        CoreDirectivesModule,\n        IonicPageModule.forChild(AddonMessageOutputAirnotifierDevicesPage),\n        TranslateModule.forChild()\n    ],\n})\nexport class AddonMessageOutputAirnotifierDevicesPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/addon/messageoutput/airnotifier/pages/devices/devices.module.ts","// (C) Copyright 2015 Martin Dougiamas\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Component, OnDestroy } from '@angular/core';\nimport { IonicPage } from 'ionic-angular';\nimport { CoreDomUtilsProvider } from '@providers/utils/dom';\nimport { AddonPushNotificationsProvider } from '@addon/pushnotifications/providers/pushnotifications';\nimport { AddonMessageOutputAirnotifierProvider } from '../../providers/airnotifier';\n\n/**\n * Page that displays the list of devices.\n */\n@IonicPage({ segment: 'addon-message-output-airnotifier-devices' })\n@Component({\n    selector: 'page-addon-message-output-airnotifier-devices',\n    templateUrl: 'devices.html',\n})\nexport class AddonMessageOutputAirnotifierDevicesPage implements OnDestroy {\n\n    devices = [];\n    devicesLoaded = false;\n\n    protected updateTimeout: any;\n\n    constructor(private domUtils: CoreDomUtilsProvider, private airnotifierProivder: AddonMessageOutputAirnotifierProvider,\n            private pushNotificationsProvider: AddonPushNotificationsProvider ) {\n    }\n\n    /**\n     * View loaded.\n     */\n    ionViewDidLoad(): void {\n        this.fetchDevices();\n    }\n\n    /**\n     * Fetches the list of devices.\n     *\n     * @return {Promise<any>} Promise resolved when done.\n     */\n    protected fetchDevices(): Promise<any> {\n        return this.airnotifierProivder.getUserDevices().then((devices) => {\n            const pushId = this.pushNotificationsProvider.getPushId();\n\n            // Convert enabled to boolean and search current device.\n            devices.forEach((device) => {\n                device.enable = !!device.enable;\n                device.current = pushId && pushId == device.pushid;\n            });\n\n            this.devices = devices;\n        }).catch((message) => {\n            this.domUtils.showErrorModal(message);\n        }).finally(() => {\n            this.devicesLoaded = true;\n        });\n    }\n\n    /**\n     * Update list of devices after a certain time. The purpose is to store the updated data, it won't be reflected in the view.\n     */\n    protected updateDevicesAfterDelay(): void {\n        // Cancel pending updates.\n        if (this.updateTimeout) {\n            clearTimeout(this.updateTimeout);\n        }\n\n        this.updateTimeout = setTimeout(() => {\n            this.updateTimeout = null;\n            this.updateDevices();\n        }, 5000);\n    }\n\n    /**\n     * Fetch devices. The purpose is to store the updated data, it won't be reflected in the view.\n     */\n    protected updateDevices(): void {\n        this.airnotifierProivder.invalidateUserDevices().finally(() => {\n            this.airnotifierProivder.getUserDevices();\n        });\n    }\n\n    /**\n     * Refresh the list of devices.\n     *\n     * @param {any} refresher Refresher.\n     */\n    refreshDevices(refresher: any): void {\n        this.airnotifierProivder.invalidateUserDevices().finally(() => {\n            this.fetchDevices().finally(() => {\n                refresher.complete();\n            });\n        });\n    }\n\n    /**\n     * Enable or disable a certain device.\n     *\n     * @param {any} device The device object.\n     * @param {boolean} enable True to enable the device, false to disable it.\n     */\n    enableDevice(device: any, enable: boolean): void {\n        device.updating = true;\n        this.airnotifierProivder.enableDevice(device.id, enable).then(() => {\n            // Update the list of devices since it was modified.\n            this.updateDevicesAfterDelay();\n        }).catch((message) => {\n            // Show error and revert change.\n            this.domUtils.showErrorModal(message);\n            device.enable = !device.enable;\n        }).finally(() => {\n            device.updating = false;\n        });\n    }\n\n    /**\n     * Page destroyed.\n     */\n    ngOnDestroy(): void {\n        // If there is a pending action to update devices, execute it right now.\n        if (this.updateTimeout) {\n            clearTimeout(this.updateTimeout);\n            this.updateDevices();\n        }\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/addon/messageoutput/airnotifier/pages/devices/devices.ts"],"sourceRoot":""}
>>>>>>> 5632a65c1fdc0002876490b68e6dc6621a0dd43d
